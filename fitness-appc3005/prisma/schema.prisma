generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Member {
  id           Int            @id @default(autoincrement())
  firstName    String
  lastName     String
  email        String         @unique
  registeredAt DateTime       @default(now())
  bookings     Booking[]
  metrics      HealthMetric[]
}

model Trainer {
  id       Int       @id @default(autoincrement())
  name     String
  email    String    @unique
  sessions Session[]
}

model Room {
  id       Int       @id @default(autoincrement())
  name     String    @unique
  capacity Int
  sessions Session[]
}

model Session {
  id        Int       @id @default(autoincrement())
  trainerId Int
  roomId    Int
  name      String
  dateTime  DateTime
  capacity  Int
  bookings  Booking[]
  room      Room      @relation(fields: [roomId], references: [id])
  trainer   Trainer   @relation(fields: [trainerId], references: [id])
}

model Booking {
  id        Int      @id @default(autoincrement())
  memberId  Int
  sessionId Int
  createdAt DateTime @default(now())
  member    Member   @relation(fields: [memberId], references: [id])
  session   Session  @relation(fields: [sessionId], references: [id])

  @@unique([memberId, sessionId])
}

model HealthMetric {
  id        Int      @id @default(autoincrement())
  memberId  Int
  timestamp DateTime @default(now())
  weight    Int
  member    Member   @relation(fields: [memberId], references: [id])
}
